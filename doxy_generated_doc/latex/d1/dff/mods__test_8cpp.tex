\hypertarget{mods__test_8cpp}{}\section{/home/jose/devel/messaging-\/cells/src/tests/modules/mods\+\_\+test.cpp File Reference}
\label{mods__test_8cpp}\index{/home/jose/devel/messaging-\/cells/src/tests/modules/mods\+\_\+test.\+cpp@{/home/jose/devel/messaging-\/cells/src/tests/modules/mods\+\_\+test.\+cpp}}


Main file for the modules example.  


{\ttfamily \#include \char`\"{}cell.\+hh\char`\"{}}\\*
{\ttfamily \#include \char`\"{}pru\+\_\+1.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}pru\+\_\+2.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}pru\+\_\+3.\+h\char`\"{}}\\*
Include dependency graph for mods\+\_\+test.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d3/db7/mods__test_8cpp__incl}
\end{center}
\end{figure}


\subsection{Detailed Description}
Main file for the modules example. 


\begin{DoxyCodeInclude}


\textcolor{comment}{/*************************************************************}
\textcolor{comment}{}
\textcolor{comment}{This file is part of messaging-cells.}
\textcolor{comment}{}
\textcolor{comment}{messaging-cells is free software: you can redistribute it and/or modify}
\textcolor{comment}{it under the terms of the version 3 of the GNU General Public }
\textcolor{comment}{License as published by the Free Software Foundation.}
\textcolor{comment}{}
\textcolor{comment}{messaging-cells is distributed in the hope that it will be useful,}
\textcolor{comment}{but WITHOUT ANY WARRANTY; without even the implied warranty of}
\textcolor{comment}{MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
\textcolor{comment}{GNU General Public License for more details.}
\textcolor{comment}{}
\textcolor{comment}{You should have received a copy of the GNU General Public License}
\textcolor{comment}{along with messaging-cells.  If not, see <http://www.gnu.org/licenses/>.}
\textcolor{comment}{}
\textcolor{comment}{------------------------------------------------------------}
\textcolor{comment}{}
\textcolor{comment}{Copyright (C) 2017-2018. QUIROGA BELTRAN, Jose Luis.}
\textcolor{comment}{Id (cedula): 79523732 de Bogota - Colombia.}
\textcolor{comment}{See https://messaging-cells.github.io/}
\textcolor{comment}{}
\textcolor{comment}{messaging-cells is free software thanks to The Glory of Our Lord }
\textcolor{comment}{    Yashua Melej Hamashiaj.}
\textcolor{comment}{Our Resurrected and Living, both in Body and Spirit, }
\textcolor{comment}{    Prince of Peace.}
\textcolor{comment}{}
\textcolor{comment}{------------------------------------------------------------*/}
\textcolor{preprocessor}{#include "\hyperlink{cell_8hh}{cell.hh}"}
\textcolor{preprocessor}{#include "pru\_1.h"}
\textcolor{preprocessor}{#include "pru\_2.h"}
\textcolor{preprocessor}{#include "pru\_3.h"}

mc\_c\_decl \textcolor{keywordtype}{int} main();

\textcolor{keywordtype}{char}* m1\_nam mc\_external\_data\_ram = mc\_cstr(\textcolor{stringliteral}{"module1"});
\textcolor{keywordtype}{char}* m2\_nam mc\_external\_data\_ram = mc\_cstr(\textcolor{stringliteral}{"module2"});
\textcolor{keywordtype}{char}* m3\_nam mc\_external\_data\_ram = mc\_cstr(\textcolor{stringliteral}{"module3"});

\textcolor{preprocessor}{#define TOT\_MODS 3}

\textcolor{preprocessor}{#define MOD1\_IDX 1}
\textcolor{preprocessor}{#define MOD2\_IDX 2}
\textcolor{preprocessor}{#define MOD3\_IDX 0}

\textcolor{keywordtype}{char}* all\_mod\_nams[TOT\_MODS] mc\_external\_data\_ram;
\hyperlink{shared__eph3_8h_ac03d1f3968bb5c52cf1de5cd9f250e66}{mc\_addr\_t}* all\_mod\_addr;

\textcolor{keywordtype}{void}
init\_module\_nams() mc\_external\_code\_ram;

\textcolor{keywordtype}{void}
init\_module\_nams()\{
    all\_mod\_nams[MOD1\_IDX] = m1\_nam;
    all\_mod\_nams[MOD2\_IDX] = m2\_nam;
    all\_mod\_nams[MOD3\_IDX] = m3\_nam;
\}


\textcolor{keywordtype}{void}
print\_module\_nams() mc\_external\_code\_ram;

\textcolor{keywordtype}{void}
print\_module\_nams()\{
    uint32\_t to\_m = mck\_get\_tot\_modules();
    uint32\_t aa = 0;
    \hyperlink{log_8h_addbe1979a58d9f84d5a009c5543818c2}{mck\_sprt2}(\textcolor{stringliteral}{"ALL\_MODULE\_NAMES=\(\backslash\)n"});
    \textcolor{keywordflow}{for}(aa = 0; aa < to\_m; aa++)\{
        \textcolor{keywordtype}{char}* nam0 = mck\_get\_module\_name(aa);
        \hyperlink{log_8h_addbe1979a58d9f84d5a009c5543818c2}{mck\_sprt2}(nam0);
        \hyperlink{log_8h_addbe1979a58d9f84d5a009c5543818c2}{mck\_sprt2}(\textcolor{stringliteral}{"\(\backslash\)n"});
    \}
\}

\textcolor{keywordtype}{void}
print\_module\_addrs() mc\_external\_code\_ram;

\textcolor{keywordtype}{void}
print\_module\_addrs()\{
    uint32\_t aa = 0;
    \hyperlink{log_8h_addbe1979a58d9f84d5a009c5543818c2}{mck\_sprt2}(\textcolor{stringliteral}{"ALL\_MODULE\_ADDRS=\(\backslash\)n"});
    \textcolor{keywordflow}{for}(aa = 0; aa < TOT\_MODS; aa++)\{
        \textcolor{keywordtype}{char}* nam0 = all\_mod\_nams[aa];
        \hyperlink{log_8h_addbe1979a58d9f84d5a009c5543818c2}{mck\_sprt2}(nam0);
        \hyperlink{log_8h_addbe1979a58d9f84d5a009c5543818c2}{mck\_sprt2}(\textcolor{stringliteral}{" addr\_\_\_\_"});
        \hyperlink{log_8h_ad30d3b396a981772ee5d44dc332c2886}{mck\_xprt}(all\_mod\_addr[aa]);
        \hyperlink{log_8h_addbe1979a58d9f84d5a009c5543818c2}{mck\_sprt2}(\textcolor{stringliteral}{"\_\_\_\_\(\backslash\)n"});
    \}
\}

\textcolor{keywordtype}{void}
link\_all\_modules\_aux\_fn() mc\_external\_code\_ram;

\textcolor{keywordtype}{void}
link\_all\_modules\_aux\_fn()\{
    m1\_main();
    m2\_main();
    m3\_main();
\}

\textcolor{keywordtype}{int} main() \{
    mck\_glb\_init(\textcolor{keyword}{false});
    \hyperlink{log_8h_a8ec0c02a2d94dec909d9cdc8340f733f}{mck\_slog2}(\textcolor{stringliteral}{"Modules main \(\backslash\)n"});

    init\_module\_nams();
    PTD\_CK(mck\_get\_tot\_modules() >= TOT\_MODS);

    all\_mod\_addr = mc\_malloc32(\hyperlink{shared__eph3_8h_ac03d1f3968bb5c52cf1de5cd9f250e66}{mc\_addr\_t}, TOT\_MODS);
    mck\_fill\_module\_external\_addresses(TOT\_MODS, all\_mod\_nams, all\_mod\_addr);

    \textcolor{keywordflow}{if}(MC\_WORKERU\_INFO->the\_workeru\_nn == 0)\{   
        \textcolor{comment}{//print\_module\_nams();}
        \textcolor{comment}{//print\_module\_addrs();}
        \textcolor{keywordtype}{bool} ok = mck\_load\_module(all\_mod\_addr[MOD2\_IDX]);
        \textcolor{keywordflow}{if}(ok)\{
            m2\_main();
        \}
    \}
    \textcolor{keywordflow}{if}(MC\_WORKERU\_INFO->the\_workeru\_nn == 1)\{   
        \textcolor{comment}{//print\_module\_nams();}
        \textcolor{comment}{//print\_module\_addrs();}
        \textcolor{keywordtype}{bool} ok = mck\_load\_module(all\_mod\_addr[MOD1\_IDX]);
        \textcolor{keywordflow}{if}(ok)\{
            m1\_main();
        \}
    \}
    \textcolor{keywordflow}{if}(MC\_WORKERU\_INFO->the\_workeru\_nn == 3)\{   
        \textcolor{comment}{//print\_module\_nams();}
        \textcolor{comment}{//print\_module\_addrs();}
        \textcolor{keywordtype}{bool} ok = mck\_load\_module(all\_mod\_addr[MOD3\_IDX]);
        \textcolor{keywordflow}{if}(ok)\{
            m3\_main();
        \}
    \}
    \hyperlink{log_8h_a8ec0c02a2d94dec909d9cdc8340f733f}{mck\_slog2}(\textcolor{stringliteral}{"\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\(\backslash\)n"});

    mck\_glb\_finish();
    \textcolor{keywordflow}{return} 0;
\}

\end{DoxyCodeInclude}
 

